
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Remini Planshet</title>
    <link rel="shortcut icon" href="1321457.png" />
    <div class="template-container">
    </div>    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet-measure/3.1.0/leaflet-measure.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet-geosearch/dist/geosearch.css" />
    <script
    src="https://cdn.jsdelivr.net/gh/gokertanrisever/leaflet-ruler@master/src/leaflet-ruler.js"
    integrity="sha384-8SqKZR7V8uOetpjjbcNJHvwuHpb074WS0UXjCLhzfJUqYn3B/uWx1WVv5mwRp1mV"
    crossorigin="anonymous"
    
></script>
<link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/gokertanrisever/leaflet-ruler@master/src/leaflet-ruler.css"
    integrity="sha384-P9DABSdtEY/XDbEInD3q+PlL+BjqPCXGcF8EkhtKSfSTr/dS5PBKa9+/PMkW2xsY"
    crossorigin="anonymous"
/>
<script
    src="https://cdn.jsdelivr.net/gh/gokertanrisever/leaflet-ruler@master/src/leaflet-ruler.js"
    integrity="sha384-8SqKZR7V8uOetpjjbcNJHvwuHpb074WS0UXjCLhzfJUqYn3B/uWx1WVv5mwRp1mV"
    crossorigin="anonymous"
></script>
    <style>
        /* General Map Styles */
        #map {
            height: 100vh;
        }

        html, body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
}

#map {
    height: 100%;
    width: 100%;
}

        /* Modal Background */
        .modal-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 1000;
            display: none;
        }
        .modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #f7f7f7, #e0e0e0);
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 1001;
            max-width: 450px;
            width: 100%;
            transition: all 0.3s ease;
        }
        .modal h2 {
            font-size: 24px;
            color: #333;
            font-family: 'Roboto', sans-serif;
            margin-bottom: 15px;
            text-align: center;
        }
        input[type="text"] {
            width: 100%;
            padding: 8px;
            font-size: 14px;
            margin-top: 10px;
            border-radius: 8px;
            border: 2px solid #ccc;
            transition: border 0.3s;
        }
        input[type="text"]:focus {
            border-color: #4a90e2;
            outline: none;
        }
        .modal-button {
            width: 100%;
            padding: 12px;
            font-size: 16px;
            margin-top: 20px;
            background-color: #4a90e2;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .modal-button:hover {
            background-color: #357ab7;
        }
        .modal-button:focus {
            outline: none;
        }
        .modal-close {
            background-color: red;
        }
        /* –°–¥–≤–∏–≥–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤–ø—Ä–∞–≤–æ –¥–ª—è –Ω—É–∂–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ */
        .shifted-info-container {
           width: 30px;
           height: 30px;
        }
        .icon-container .shifted-info-containerr {
            margin-right: 70px;
        }
    
        .red-id {
            color: red;
        }
        .blue-id {
            color: #006aff;
        }
        

        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ç–µ–∫—Å—Ç–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ü–≤–µ—Ç–∞ */
.red-id .label-container,
.red-id .r-container,
.red-id .rls-container 
.red-id .icon-container {
    color: red;
}

.blue-id .label-container,
.blue-id .r-container,
.blue-id .rls-container 
.blue-id .icon-container {
    color: #006aff; /* –°–∏–Ω–∏–π —Ü–≤–µ—Ç –¥–ª—è —Ç–µ–∫—Å—Ç–∞ */
}
        .shifted-id-x-101 {
            margin-left: 20px;
       }
        .shifted-id {
            margin-left: 15px;
        }
        .shifted-id-grumble {
            margin-left: 25px;
        }
        .shifted-id-kinzhal {
            margin-left: 25px;
        }
        .info-container {
            line-height: 22px;
            text-align: center;
        }
        .label-container {
            font-size: 14px;
            font-weight: 600;
                    font-family: 'Roboto', sans-serif;
 
            -webkit-text-stroke-color: black;
        }
        .r-container {
            font-size: 14px;
            font-weight: 600;
            font-family: 'Roboto', sans-serif;
 
        }
        .rls1-container {
            font-size: 14px;
            font-family: 'Roboto', sans-serif;
 
            display: flex;
    flex-direction: column;
    justify-content: center;
    font-weight: 600;
   }
        .rls-container {
            font-size: 14px;
            display: flex;
            font-family: 'Roboto', sans-serif;
            font-weight: 600;
    flex-direction: column;
    justify-content: center;
   }
   .info-container {
            line-height: 16,5px;
        }
        .label1-container {
            font-size: 14px;
            font-family: 'Roboto', sans-serif;
            font-weight: 600;
            -webkit-text-stroke-color: black;
        }
        .r1-container {
            font-size: 14px;
            font-weight: 600;
            font-family: 'Roboto', sans-serif;
 
        }
        /* Delete Button */
        #deleteButton {
    position: absolute;
    bottom: 30px;
    left: 10px;
    background: transparent;
    color: white;
    padding: 15px 25px;
    font-size: 18px;
    border-radius: 8px;
    cursor: pointer;
    border: none;
    box-shadow: none;
    transition: all 0.3s ease;
    z-index: 1003;
    text-align: left;
    padding-left: 7px;
}

/* üì± –ù–∞ —ç–∫—Ä–∞–Ω–∞—Ö –¥–æ 600px ‚Äî —Å–¥–≤–∏–≥–∞–µ–º –µ—â—ë –ª–µ–≤–µ–µ */
@media (max-width: 600px) {
    #deleteButton {
        left: 0px;
    }
}


@media (max-width: 600px) {
    #sidebar {
        width: 40px;
    }
}
        /* Smooth Transition for Modals */  
        .modal.show {
            display: block;
            animation: fadeIn 0.3s ease-out;
        }
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
        .icon-container {
    display: flex;
    flex-direction: column; /* –†–∞–∑–º–µ—â–∞–µ—Ç —ç–ª–µ–º–µ–Ω—Ç—ã –≤ —Å—Ç–æ–ª–±–µ—Ü */
    align-items: center;
    gap: 5px;
    font-size: 14px;
    position: absolute;
}       
 .icon-container .icon {
            width: 27px;
            height: 27px;
            object-fit: cover;
            display: block;
        }


        /* Modal Input Background for Target Coordinates */
        #targetModal {
            padding: 20px;
            border-radius: 10px;
        }
        #alert-container {
            position: absolute;
            top: 10px;
            left: 10px;
            z-index: 1000;
        }
        #alert-menu {
            background: white;
            padding: 15px;
            display: none;
            border: 2px solid #333;
            border-radius: 8px;
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.2);
            width: 200px;
            font-family: Arial, sans-serif;
        }
        #alert-menu h3 {
            margin: 0 0 10px;
            text-align: center;
            font-size: 16px;
            color: #333;
        }
        #alert-menu div {
            margin-bottom: 5px;
        }
        #alert-menu input[type=checkbox] {
            margin-right: 5px;
        }
        button#alert-button {
            background: #ff0800;
            color: white;
            border: none;
            padding: 10px;
            cursor: pointer;
            width: 150px;
            border-radius: 5px;
            transition: background 0.3s;
        }
        button#alert-button:hover {
            background: #c9302c;
        }
        #overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: url('kod.png') center/cover no-repeat;
    pointer-events: none; /* –ü–æ–∑–≤–æ–ª—è–µ—Ç –∫–ª–∏–∫–∞–º –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —Å–∫–≤–æ–∑—å */
    z-index: 1000; /* –ü–æ–≤–µ—Ä—Ö –∫–∞—Ä—Ç—ã */
    opacity: 0.2; /* –°–¥–µ–ª–∞—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É –º–µ–Ω–µ–µ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ–π */
    transition: filter 0.3s ease; /* –ü–ª–∞–≤–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ —Ñ–∏–ª—å—Ç—Ä–∞ */
}
/* –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è –≤—Å–ø–ª—ã–≤–∞—é—â–µ–≥–æ –æ–∫–Ω–∞ */
.leaflet-popup-content {
    background-color: #f0f0f0; /* –°–≤–µ—Ç–ª—ã–π —Ñ–æ–Ω */
    color: #333;               /* –¢–µ–º–Ω—ã–π —Ü–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞ */
    padding: 10px;
    border-radius: 10px;       /* –°–∫—Ä—É–≥–ª–µ–Ω–Ω—ã–µ —É–≥–ª—ã */
    font-family: 'Arial', sans-serif;
    font-size: 14px;
}

/* –°—Ç–∏–ª—å –¥–ª—è —Å—Ç—Ä–µ–ª–æ—á–∫–∏ –≤—Å–ø–ª—ã–≤–∞—é—â–µ–≥–æ –æ–∫–Ω–∞ */
.leaflet-popup-tip {
    background-color: #f0f0f0;
}

/* –°—Ç–∏–ª—å –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ –≤ –æ–∫–Ω–µ */
.leaflet-popup-content h3 {
    margin-top: 0;
    font-size: 16px;
    color: #555;
}
.leaflet-control.ruler {
        position: absolute;
        bottom: 10px;
        right: 10px;
        left: auto;
        top: auto;
      }
      * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Arial", sans-serif;
        }

        body {
            background: #f0f0f0;
        }

        /* –°—Ç–∏–ª–∏ –º–µ–Ω—é */
        #passwordContainer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0033cc, #0066ff); /* –ì—Ä–∞–¥–∏–µ–Ω—Ç —Å–∏–Ω–µ–≥–æ */
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            color: white;
            text-align: center;
            z-index: 1005;
        }

        #passwordContainer h1 {
            font-size: 28px;
            margin-bottom: 120px;
            letter-spacing: 1px;
        }

        #passwordInput {
            width: 250px;
            padding: 12px;
            font-size: 18px;
            border: none;
            border-radius: 5px;
            outline: none;
            text-align: center;
            margin-bottom: 15px;
        }

        #submitButton {
            padding: 12px 25px;
            font-size: 18px;
            background: #ffffff;
            color: rgb(0, 0, 0);
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: 0.3s;
        }

        #submitButton:hover {
            background: #9d9d9d;
        }
        #menu-icon {
    position: absolute;
    top: 17px;  /* –†–∞—Å–ø–æ–ª–∞–≥–∞–µ–º —Å–≤–µ—Ä—Ö—É */
    left: 20px; /* –ò–∫–æ–Ω–∫–∞ –±—É–¥–µ—Ç —Å–ª–µ–≤–∞ */
    width: 170px;  /* –ó–∞–¥–∞–µ–º —Ä–∞–∑–º–µ—Ä –∏–∫–æ–Ω–∫–∏ (–ø–æ –∂–µ–ª–∞–Ω–∏—é) */
    height: 25px; /* –ó–∞–¥–∞–µ–º —Ä–∞–∑–º–µ—Ä –∏–∫–æ–Ω–∫–∏ (–ø–æ –∂–µ–ª–∞–Ω–∏—é) */
}
    </style>
</head>
<body>
    <div id="map"></div>
    <div class="overlay"></div>
    <button id="deleteButton"><i class="fas fa-trash-alt"></i> –£–¥–∞–ª–∏—Ç—å –æ–±—ä–µ–∫—Ç</button>
<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç -->
<div class="modal" id="coordinatesModal">
    <h2>–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:</h2>
    <p id="coordinates"></p>
    <button onclick="closeModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
</div>
<div id="overlay"></div>


    <!-- Modal Elements -->
    <div class="modal-background" id="modalBackground"></div>
    <div class="modal" id="speedModal">
        <h2><i class="fas fa-tachometer-alt"></i> –í–≤–µ–¥–∏—Ç–µ —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—ä–µ–∫—Ç–∞ (–∫–º/—á):</h2>
        <input type="text" id="speedInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–∫–æ—Ä–æ—Å—Ç—å" />
        <button class="modal-button" id="speedSubmit"><i class="fas fa-check"></i> –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
        <button class="modal-button modal-close" id="speedClose"><i class="fas fa-times"></i> –ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
    <div class="modal-background" id="modalBackground"></div>
    <div class="modal" id="targetModal">
        <h2><i class="fas fa-map-marker-alt"></i> –í–≤–µ–¥–∏—Ç–µ —Ü–µ–ª—å (–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä: 53.9,27.5667):</h2>
        <input type="text" id="targetInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã" />
        <button class="modal-button" id="targetSubmit"><i class="fas fa-check"></i> –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
        <button class="modal-button modal-close" id="targetClose"><i class="fas fa-times"></i> –ó–∞–∫—Ä—ã—Ç—å</button>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-measure/3.1.0/leaflet-measure.js"></script>
    <script src="https://unpkg.com/leaflet-geosearch/dist/bundle.min.js"></script>
    <script
    src="https://cdn.jsdelivr.net/gh/gokertanrisever/leaflet-ruler@master/src/leaflet-ruler.js"
    integrity="sha384-8SqKZR7V8uOetpjjbcNJHvwuHpb074WS0UXjCLhzfJUqYn3B/uWx1WVv5mwRp1mV"
    crossorigin="anonymous"
></script>
    <script>
        const map = L.map('map', {
            zoomControl: false
        }).setView([48.3794, 31.1656], 7);

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
        }).addTo(map);
        
        
// –û—Å–Ω–æ–≤–Ω–æ–π —Å–ª–æ–π –∫–∞—Ä—Ç—ã (OSM)
const osmLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZwoom: 19,
    attribution: '¬© OpenStreetMap contributors'
});

// –ß–µ—Ä–Ω–∞—è OSM-–∫–∞—Ä—Ç–∞ (CartoDB Dark Matter)
const darkLayer = L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
    maxZoom: 19,
    attribution: '¬© <a href="https://carto.com/">CARTO</a>'
});

// –°–ø—É—Ç–Ω–∏–∫–æ–≤–∞—è –∫–∞—Ä—Ç–∞ —Å –≥—Ä–∞–Ω–∏—Ü–∞–º–∏ (Esri World Imagery with Labels)
const satelliteLayerWithBorders = L.layerGroup([
    L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
        maxZoom: 19,
        attribution: 'Tiles ¬© Esri ‚Äî Source: Esri, i-cubed, USDA, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community'
    }),
    L.tileLayer('https://services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}', {
        maxZoom: 19,
        attribution: 'Boundaries and labels ¬© Esri'
        
    })
    
]);
var Stadia_AlidadeSmoothDark = L.tileLayer('https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.{ext}', {
	minZoom: 0,
	maxZoom: 20,
	attribution: '&copy; <a href="https://www.stadiamaps.com/" target="_blank">Stadia Maps</a> &copy; <a href="https://openmaptiles.org/" target="_blank">OpenMapTiles</a> &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
	ext: 'png'
});

const googleStreets = L.tileLayer('http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}',{
        maxZoom: 20,
        subdomains:['mt0','mt1','mt2','mt3']
});

googleHybrid = L.tileLayer('http://{s}.google.com/vt/lyrs=s,h&x={x}&y={y}&z={z}',{
        maxZoom: 20,
        subdomains:['mt0','mt1','mt2','mt3']
});

googleTerrain = L.tileLayer('http://{s}.google.com/vt/lyrs=p&x={x}&y={y}&z={z}',{
        maxZoom: 20,
        subdomains:['mt0','mt1','mt2','mt3']
});
var OpenTopoMap = L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png', {
	maxZoom: 17,
	attribution: 'Map data: &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, <a href="http://viewfinderpanoramas.org">SRTM</a> | Map style: &copy; <a href="https://opentopomap.org">OpenTopoMap</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)'
});

var OPNVKarte = L.tileLayer('https://tileserver.memomaps.de/tilegen/{z}/{x}/{y}.png', {
	maxZoom: 18,
	attribution: 'Map <a href="https://memomaps.de/">memomaps.de</a> <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
});
var Esri_WorldTopoMap = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}', {
	attribution: 'Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ, TomTom, Intermap, iPC, USGS, FAO, NPS, NRCAN, GeoBase, Kadaster NL, Ordnance Survey, Esri Japan, METI, Esri China (Hong Kong), and the GIS User Community'
});
var Stadia_OSMBright = L.tileLayer('https://tiles.stadiamaps.com/tiles/osm_bright/{z}/{x}/{y}{r}.{ext}', {
	minZoom: 0,
	maxZoom: 20,
	attribution: '&copy; <a href="https://www.stadiamaps.com/" target="_blank">Stadia Maps</a> &copy; <a href="https://openmaptiles.org/" target="_blank">OpenMapTiles</a> &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
	ext: 'png'
});

// –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –∫–∞—Ä—Ç—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
satelliteLayerWithBorders.addTo(map);

// –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–ª–æ–µ–≤ –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
const baseLayers = {
    "OSM": osmLayer,
    "OSM Black": darkLayer,
    "Satellite": satelliteLayerWithBorders,
    "Google Maps": googleStreets,
    "Google Hybrid": googleHybrid,
    "Google Terrain": googleTerrain,
    "OpenTopoMap": OpenTopoMap,
    "OPNVKarte": OPNVKarte,
    "Ersi": Esri_WorldTopoMap,
    "Stadia White": Stadia_OSMBright,
    "Stadia Dark": Stadia_AlidadeSmoothDark
};

// –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–Ω—Ç—Ä–æ–ª –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –∫–∞—Ä—Ç
L.control.layers(baseLayers).addTo(map);

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–∞ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏
function updateOverlayFilter() {
    const overlay = document.querySelector('.overlay');
    if (map.hasLayer(darkLayer)) {
        overlay.style.filter = 'invert(1) brightness(2)';
    } else {
        overlay.style.filter = 'none';
    }
}

// –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∏–ª–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Å–ª–æ—è —Ç–µ–º–Ω–æ–π –∫–∞—Ä—Ç—ã
map.on('layeradd', updateOverlayFilter);
map.on('layerremove', updateOverlayFilter);

// –ï—Å–ª–∏ –∫–∞—Ä—Ç–∞ —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞, —Å—Ä–∞–∑—É –ø—Ä–∏–º–µ–Ω–∏–º —Ñ–∏–ª—å—Ç—Ä
updateOverlayFilter();

        let currentObjectId = 9500;
        let deleteMode = false;
        const markers = [];

        function calculateCourse(lat1, lng1, lat2, lng2) {
            const dLng = (lng2 - lng1) * Math.PI / 180;
            const lat1Rad = lat1 * Math.PI / 180;
            const lat2Rad = lat2 * Math.PI / 180;

            return Math.atan2(
                Math.sin(dLng) * Math.cos(lat2Rad),
                Math.cos(lat1Rad) * Math.sin(lat2Rad) - 
                Math.sin(lat1Rad) * Math.cos(lat2Rad) * Math.cos(dLng)
            );
        }

        function calculateNewPosition(lat, lng, speed, time, targetLat, targetLng) {
            const distance = (speed / 3600) * time;
            const earthRadius = 6371;
            const bearing = calculateCourse(lat, lng, targetLat, targetLng);

            const latRadians = (lat * Math.PI) / 180;
            const lngRadians = (lng * Math.PI) / 180;

            const newLatRadians = Math.asin(
                Math.sin(latRadians) * Math.cos(distance / earthRadius) + 
                Math.cos(latRadians) * Math.sin(distance / earthRadius) * Math.cos(bearing)
            );

            const newLngRadians =
                lngRadians +
                Math.atan2(
                    Math.sin(bearing) * Math.sin(distance / earthRadius) * Math.cos(latRadians),
                    Math.cos(distance / earthRadius) - Math.sin(latRadians) * Math.sin(newLatRadians)
                );

            return [
                (newLatRadians * 180) / Math.PI,
                (newLngRadians * 180) / Math.PI
            ];
        }
        

        function haversine(lat1, lng1, lat2, lng2) {
            const R = 6371;
            const dLat = ((lat2 - lat1) * Math.PI) / 180;
            const dLng = ((lng2 - lng1) * Math.PI) / 180;

            const a =
                Math.sin(dLat / 2) * Math.sin(dLat / 2) +
                Math.cos((lat1 * Math.PI) / 180) *
                Math.cos((lat2 * Math.PI) / 180) *
                Math.sin(dLng / 2) * Math.sin(dLng / 2);

            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
            return R * c;
        }

        function generateId() {
            return currentObjectId++;
        }

        // Show modal and handle speed input
        function showSpeedModal(callback) {
            const modal = document.getElementById('speedModal');
            const modalBackground = document.getElementById('modalBackground');
            const speedInput = document.getElementById('speedInput');
            const submitButton = document.getElementById('speedSubmit');
            const closeButton = document.getElementById('speedClose');
            
            modal.classList.add('show');
            modalBackground.style.display = 'none';

            submitButton.onclick = () => {
                const speed = parseFloat(speedInput.value);
                if (!isNaN(speed)) {
                    callback(speed);
                    closeModal();
                } else {
                    alert('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å!');
                }
            };

            closeButton.onclick = closeModal;

            function closeModal() {
                modal.classList.remove('show');
                modalBackground.style.display = 'none';
                closeModal = ""
            }

            modal.classList.add('show');
            modalBackground.style.display = 'none';
        }

        // Show modal and handle target input
        function showTargetModal(callback) {
            const modal = document.getElementById('targetModal');
            const modalBackground = document.getElementById('modalBackground');
            const targetInput = document.getElementById('targetInput');
            const submitButton = document.getElementById('targetSubmit');
            const closeButton = document.getElementById('targetClose');
            
            modal.classList.add('show');
            modalBackground.style.display = 'block';

            submitButton.onclick = () => {
                const [targetLat, targetLng] = targetInput.value.split(',').map(coord => parseFloat(coord));
                if (!isNaN(targetLat) && !isNaN(targetLng)) {
                    callback(targetLat, targetLng);
                    closeModal();
                } else {
                    alert('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ü–µ–ª–∏!');
                }
            };

            closeButton.onclick = closeModal;

            function closeModal() {
                modal.classList.remove('show');
                modalBackground.style.display = 'none';
            }
        }

        map.on('click', (e) => {
            if (deleteMode) return;

            const { lat, lng } = e.latlng;

            // Get speed input via modal
            showSpeedModal((speed) => {
                // Get target input via modal
                showTargetModal((targetLat, targetLng) => {

            const objectId = generateId();
            let iconUrl;
            let iconClass = 'red-id';
            let shiftedClass = ''
            let iconSize = ''
            let shiftedClasss = ''
            if (speed === 0) {  
    // –ï—Å–ª–∏ —Å–∫–æ—Ä–æ—Å—Ç—å 0, —Å—Ä–∞–∑—É —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–∫–æ–Ω–∫—É EPVO
    iconUrl = 'EPVO.png'; 
    iconClass = 'blue-id';  

    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º ID –æ—Ç 500000 –∏ –≤—Ä–µ–º—è –ø–æ –ú–∏–Ω—Å–∫—É
    const objectId1 = getNextObjectId(); 
    const kievTime = getKievTime();

    // –ú–µ–Ω—è–µ–º iconHtml –ü–û–õ–ù–û–°–¢–¨–Æ
    iconHtml = `
        <div class="icon-container ${iconClass}">
            <img src="${iconUrl}" class="icon" />
            <div class="info-container ${shiftedClass} ${shiftedClasss}">
                <span class="label1-container ${iconClass}">${objectId} ${kievTime}</span>
                <div class="info-container ${shiftedClass} ${shiftedClasss}">
                <span class="r1-container ${iconClass}">–ï–ü–ü–û</span>
                <span class="rls1-container ${iconClass}">${objectId1}</span>
            </div>
                        </div>
        </div>
    `;
    // –£–¥–∞–ª—è–µ–º –º–∞—Ä–∫–µ—Ä —á–µ—Ä–µ–∑ 15 –º–∏–Ω—É—Ç (900000 –º—Å)
setTimeout(() => {
    marker.remove();
}, 1200000);
} else {
    // –£—Å–ª–æ–≤–∏—è –¥–ª—è –≤—ã–±–æ—Ä–∞ –∏–∫–æ–Ω–∫–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏
    if (speed >= 120 && speed <= 121) {
        iconUrl = 'supercam.png';
    } else if (speed > 120 && speed <= 200) {
        iconUrl = 'shahed.png';
    } else if (speed > 90 && speed <= 99) {
        iconUrl = 'gerbera.png';
    } else if (speed >= 7559 && speed < 7560) {
        iconUrl = 'iskander.png';
        shiftedClass = 'shifted-info-container';
    } else if (speed >= 950 && speed <= 951) {
        iconUrl = 'kalibr.png';
        shiftedClass = 'shifted-info-container';
    } else if (speed >= 1000 && speed <= 1001) {
        iconUrl = 'x101.png';
        shiftedClass = 'shifted-info-container';
    } else if (speed >= 450 && speed <= 451) {
        iconUrl = 'kab.png';
    } else if (speed >= 11024 && speed <= 11025) {
        shiftedClass = 'shifted-info-container';
        iconUrl = 'Tsirkon.png';
    } else if (speed >= 14687 && speed <= 14688) {
        shiftedClass = 'shifted-info-container';
        iconUrl = 'Kinzhal.png';
    } else if (speed >= 4899 && speed <= 4900) {
        shiftedClass = 'shifted-info-container';
        iconUrl = 'Kh-22.png';
    } else if (speed >= 1049 && speed <= 1050) {
        shiftedClass = 'shifted-info-container';
        iconUrl = 'Kh-59.png';
    } else if (speed >= 80 && speed <= 85) {
        iconUrl = 'parodia.png';
    } else if (speed >= 290 && speed <= 291) {
        iconUrl = 'Lancet.png';
    } else if (speed >= 98 && speed <= 99) {
        iconUrl = 'gerbera.png';
    } else if (speed >= 100 && speed <= 101) {
        iconUrl = 'ZZala.png';
    } else if (speed >= 4500 && speed <= 4501) {
        iconUrl = 'grumble.png';
        shiftedClass = 'shifted-info-container';
    } else if (speed >= 1030 && speed <= 1031) {
        shiftedClass = 'shifted-info-container';
        iconUrl = 'kh-69.png';
    } else if (speed >= 109 && speed <= 110) {
        iconUrl = 'orlan.png';
    } else if (speed >= 5400 && speed <= 5401) {
        iconUrl = 'atacms.png';
        shiftedClass = 'shifted-info-container';
        iconClass = 'blue-id'; // –°–∏–Ω–∏–π ID –¥–ª—è ATACMS
        lineColor = '#006aff';  // Set blue line color for blue objects
    } else if (speed >= 959 && speed <= 960) {
        iconUrl = 'storm-shadow.png';
        shiftedClass = 'shifted-info-container';
        iconClass = 'blue-id';
        lineColor = '#006aff';  // Set blue line color for blue objects
    } else if (speed >= 190 && speed <= 191) {
        iconUrl = 'lutiy.png';
        iconClass = 'blue-id';
        lineColor = '#006aff';  // Set blue line color for blue objects
    } else if (speed >= 201 && speed <= 202) {
        iconUrl = 'beaver.png';
        iconClass = 'blue-id';
        lineColor = '#006aff';  // Set blue line color for blue objects
    } else if (speed >= 329 && speed <= 330) {
        iconUrl = 'rys`.png';
        iconClass = 'blue-id';
        lineColor = '#006aff';  // Set blue line color for blue objects
    } else if (speed >= 74 && speed <= 75) {
        iconUrl = 'Molnia.png';
    } else if (speed >= 3000 && speed <= 3001) {
        iconUrl = 'gmlrs.png';
        shiftedClass = 'shifted-info-container';
        iconClass = 'blue-id';
    } else if (speed >= 900 && speed <= 901) {
        iconUrl = 'iskander-k.png';
        shiftedClass = 'shifted-info-container';
    } else if (speed >= 2519 && speed <= 2520) {
        iconUrl = 'kh31.png';
        shiftedClass = 'shifted-info-container';
    } else if (speed >= 1100 && speed <= 1101) {
        iconUrl = 'su-24.png';
    } else if (speed >= 1102 && speed <= 1103) {
        iconUrl = 'su-24 BLR.png';
        iconClass = 'blue-id';
    } else if (speed >= 1002 && speed <= 1003) {
        iconUrl = 'f-16.png';
        iconClass = 'blue-id';
    } else if (speed >= 1200 && speed <= 1201) {
        iconUrl = 'Su-34.png';
    } else if (speed >= 1600 && speed <= 1601) {
        iconUrl = 'Su-57.png';
    } else if (speed >= 1204 && speed <= 1205) {
        iconUrl = 'Su-30.png';
    } else if (speed >= 1202 && speed <= 1203) {
        iconUrl = 'Su-30 BLR.png';
        iconClass = 'blue-id';  
    } else if (speed >= 1400 && speed <= 1401) {
        iconUrl = 'Su-35.png';
    } else if (speed >= 2300 && speed <= 2301) {
        iconUrl = 'Tu-22M3.png';
    } else if (speed >= 952 && speed <= 953) {
         iconUrl = 'Su25.png';
    } else if (speed >= 954 && speed <= 955) {
        iconUrl = 'Su25 BLR.png';
        iconClass = 'blue-id';  
    } else if (speed >= 850 && speed <= 851) {
        iconUrl = 'mig-29 BLR.png';
        iconClass = 'blue-id';  
    } else if (speed >= 961 && speed <= 962) {
         iconUrl = 'kh-35.png';
         shiftedClass = 'shifted-info-container';
    } else if (speed >= 3180 && speed <= 3181) {
        iconUrl = 'oniks.png';
        shiftedClass = 'shifted-info-container';
    } else if (speed >= 500 && speed <= 501) {
        iconUrl = 'shahed 238.png';
    } else if (speed >= 2400 && speed <= 2450) {
        iconUrl = 'mig-31.png';
    } else if (speed >= 800 && speed <= 801) {
        iconUrl = 'a-50.png';
    } else if (speed >= 1110 && speed <= 1111) {
        iconUrl = 'mirage.png';
        iconClass = 'blue-id';  
    } else {
        // –ï—Å–ª–∏ —Å–∫–æ—Ä–æ—Å—Ç—å –Ω–µ –ø–æ–ø–∞–ª–∞ –Ω–∏ –≤ –æ–¥–Ω–æ —É—Å–ª–æ–≤–∏–µ, —Å—Ç–∞–≤–∏–º "neyst tip.png"
        iconUrl = 'neyst tip.png';
    }

    // –û—Å–Ω–æ–≤–Ω–æ–π —à–∞–±–ª–æ–Ω –¥–ª—è –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤
    iconHtml = `
        <div class="icon-container ${iconClass}">
            <img src="${iconUrl}" class="icon" />
             <div class="info-container ${shiftedClass} ${shiftedClasss}">
            </div>
        </div>
    `;
}
                    const icon = L.divIcon({
                        className: 'icon',
                        html: iconHtml,
                        iconSize: [30, 30],
                        iconAnchor: [20, 20],
                    });

                    const marker = L.marker([lat, lng], { icon }).addTo(map);
                    

// –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö –Ω–∞–∑–≤–∞–Ω–∏–π —Å —Ä—É—Å—Å–∫–∏–º–∏
const translations = {
    "supercam": "Supercam",
    "shahed": "Shahed",
    "iskander": "–ò—Å–∫–∞–Ω–¥–µ—Ä-–ú",
    "kalibr": "–ö–∞–ª–∏–±—Ä",
    "x101": "–•-101",
    "kab": "–ö–ê–ë",
    "Tsirkon": "–¶–∏—Ä–∫–æ–Ω",
    "Kinzhal": "–ö–∏–Ω–∂–∞–ª",
    "Kh-22": "–•-22",
    "Kh-59": "–•-59",
    "parodia": "–ü–∞—Ä–æ–¥–∏—è",
    "Lancet": "–õ–∞–Ω—Ü–µ—Ç",
    "gerbera": "–ì–µ—Ä–±–µ—Ä–∞",
    "ZZala": "–ó–∞–ª–∞",
    "grumble": "–ó–£–†",
    "kh-69": "–•-69",
    "orlan": "–û—Ä–ª–∞–Ω",
    "atacms": "ATACMS",
    "storm-shadow": "Storm Shadow",
    "lutiy": "–õ—é—Ç—ã–π",
    "beaver": "–ë–æ–±—ë—Ä",
    "rys`": "–†—ã—Å—å",
    "Molnia": "–ú–æ–ª–Ω–∏—è",
    "gmlrs": "GMLRS",
    "iskanderk": "–ò—Å–∫–∞–Ω–¥–µ—Ä-–ö",
    "kh31": "–•-31",
    "su-24": "–°—É-24",
    "f-16": "F-16",
    "Su-34": "–°—É-34",
    "Su-57": "–°—É-57",
    "su-30": "–°—É-30",
    "Su-30 BLR": "–°—É-30 (–ë–µ–ª–∞—Ä—É—Å—å)",
    "Su-35": "–°—É-35",
    "Tu-22M3": "–¢—É-22–ú3",
    "mirage": "Mirage-2000",
    "neyst tip": "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø"
};

// –ü–æ–ª—É—á–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –±–µ–∑ ".png"
let objectKey = iconUrl.replace('.png', '').replace(/-/g, ' ');

// –ü–µ—Ä–µ–≤–æ–¥–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ, –µ—Å–ª–∏ –æ–Ω–æ –µ—Å—Ç—å –≤ —Å–ª–æ–≤–∞—Ä–µ, –∏–Ω–∞—á–µ –æ—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –µ—Å—Ç—å
let objectType = translations[objectKey] || objectKey;

// –ü—Ä–∏–≤–æ–¥–∏–º –∫ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É (–∫–∞–∂–¥–æ–µ —Å–ª–æ–≤–æ —Å –±–æ–ª—å—à–æ–π –±—É–∫–≤—ã)
objectType = objectType.split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');

// –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ popup
const customPopupContent = `
    <div class="custom-popup">
        <p><strong>–¶–ï–õ–¨ (2111):</strong> ${objectType}</p>
        <p><strong>–°–ö–û–†–û–°–¢–¨ (2818):</strong> ${speed} –ö–ú/–ß</p>
    </div>
`;

// –ü—Ä–∏–≤—è–∑—ã–≤–∞–µ–º –∫–∞—Å—Ç–æ–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –≤—Å–ø–ª—ã–≤–∞—é—â–µ–µ –æ–∫–Ω–æ
marker.bindPopup(customPopupContent);

// –°–ª—É—à–∞–µ–º –∫–ª–∏–∫ –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –æ–∫–Ω–∞
marker.on('click', function() {
    marker.openPopup();
});




                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å–ª–∏ —Å–∫–æ—Ä–æ—Å—Ç—å –±–æ–ª—å—à–µ 0, —Ç–æ –ø–æ–≤–æ—Ä–∞—á–∏–≤–∞–µ–º –∏–∫–æ–Ω–∫—É
if (speed > 0) {
    const course = calculateCourse(lat, lng, targetLat, targetLng) * (180 / Math.PI);
    const angle = (course + 360) % 360;
    marker._icon.querySelector('.icon').style.transform = `rotate(${angle}deg)`;
} else {
    // –ï—Å–ª–∏ —Å–∫–æ—Ä–æ—Å—Ç—å 0, –Ω–µ –≤—Ä–∞—â–∞–µ–º –∏–∫–æ–Ω–∫—É (—Å–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ–≤–æ—Ä–æ—Ç)
    marker._icon.querySelector('.icon').style.transform = `rotate(0deg)`;
}

let startTime = null;
function updatePosition(timestamp) {                                                                                    
    if (!startTime) startTime = timestamp;
    const elapsedTime = (timestamp - startTime) / 1000; // –≤—Ä–µ–º—è –≤ —Å–µ–∫—É–Ω–¥–∞—Ö

    const [newLat, newLng] = calculateNewPosition(lat, lng, speed, elapsedTime, targetLat, targetLng);
    marker.setLatLng([newLat, newLng]);

    if (haversine(newLat, newLng, targetLat, targetLng) > 1) {
        requestAnimationFrame(updatePosition);
    } else {
        marker.remove(); // –£–¥–∞–ª–∏—Ç—å –º–∞—Ä–∫–µ—Ä, –µ—Å–ª–∏ —Ü–µ–ª—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞
    }
}

requestAnimationFrame(updatePosition);


                    marker.on('click', function () {
        if (deleteMode) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –æ–±—ä–µ–∫—Ç?')) {
                // –°–∫—Ä—ã–≤–∞–µ–º –º–∞—Ä–∫–µ—Ä, –∞ –Ω–µ —É–¥–∞–ª—è–µ–º –µ–≥–æ
                marker.remove();
                // –∏–ª–∏ marker.setVisible(false); // –î–ª—è –¥—Ä—É–≥–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫

                deleteMode = false;
                const deleteButton = document.getElementById('deleteButton');
                deleteButton.style.backgroundColor = 'red';
                deleteButton.innerHTML = '<i class="fas fa-trash-alt"></i> –£–¥–∞–ª–∏—Ç—å –æ–±—ä–µ–∫—Ç';
            }
        }
    });

                });
            });
        });

       document.getElementById('deleteButton').onclick = function () {
    deleteMode = !deleteMode;
    
    // –ò–∑–º–µ–Ω—è–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –æ—Å—Ç–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
    if (deleteMode) {
        this.style.backgroundColor = 'green';
        this.innerHTML = '<i class="fas fa-check"></i> –í—ã—Ö–æ–¥ –∏–∑ —Ä–µ–∂–∏–º–∞ —É–¥–∞–ª–µ–Ω–∏—è'; // –ò–∑–º–µ–Ω—è–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç
    } else {
        this.style.backgroundColor = 'red';
        this.innerHTML = '<i class="fas fa-trash-alt"></i> –£–¥–∞–ª–∏—Ç—å –æ–±—ä–µ–∫—Ç'; // –ò–∑–º–µ–Ω—è–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç
    }
};

        window.addEventListener('beforeunload', (event) => {
            event.preventDefault();
            event.returnValue = '';
        });
        // –†–õ–° –¥–ª—è –æ–±—ä–µ–∫—Ç–æ–≤
        const rlsOptions = [
    "59H6-E",
    "–†–æ–¥–Ω–∏–∫",
    "–†–æ—Å–∞-–†–ë-–ú",
    "–í–æ—Å—Ç–æ–∫-3D",
    "5–ù84–ê",
    "19–ñ6–ú",
    "–ú–∞–ª–∞—Ö–∏—Ç"
]; // –ò—Å–∫–ª—é—á–∞–µ–º "–í–æ–ª–≥–∞" –∏–∑ –æ–±—â–µ–≥–æ —Å–ø–∏—Å–∫–∞

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã–±–æ—Ä–∞ –†–õ–°
function getRlsForObject(objectId, iconUrl) {
    // –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –†–õ–° –¥–ª—è Iskander-M, Tsircon, Kinzhal, Atacms
    const specialRls = ["iskander.png", "Tsirkon.png", "Kinzhal.png", "atacms.png"];
    let rls = "–í–æ–ª–≥–∞"; // –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤

    if (specialRls.includes(iconUrl)) {
        return rls; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º "–í–æ–ª–≥–∞" —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
    } else {
        // –î–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –≤—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—É—é –†–õ–°, –∏—Å–∫–ª—é—á–∞—è "–í–æ–ª–≥–∞"
        const randomIndex = Math.floor(Math.random() * rlsOptions.length);
        return rlsOptions[randomIndex];
    }
}
map.on('contextmenu', function (e) {
    const coords = `${e.latlng.lat}, ${e.latlng.lng}`;
    navigator.clipboard.writeText(coords).then(() => {
        alert(`–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã: ${coords}`);
    }).catch(err => {
        console.error('–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç:', err);
    });
});
fetch("front.json")
  .then(response => response.json())
  .then(data => {
    L.geoJSON(data, {
      style: function(feature) {
        let color = '#bdbdbd'; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ü–≤–µ—Ç "–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"
        let opacity = 1; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–µ–ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –¥–ª—è "–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"
        let fillOpacity = 1; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∑–∞–ª–∏–≤–∫–∞ –Ω–µ–ø—Ä–æ–∑—Ä–∞—á–Ω–∞—è

        if (feature.properties.name === '–û—Å–≤–æ–±–æ–∂–¥–µ–Ω–æ') {
          color = '#0f9d58'
          opacity = 0.0; // –ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –≥—Ä–∞–Ω–∏—Ü—ã
          fillOpacity = 0.15; // –ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –∑–∞–ª–∏–≤–∫–∏
        } else if (feature.properties.name === '–û–∫–∫—É–ø–∏—Ä–æ–≤–∞–Ω–æ') {
          color = '#a52714'; // –¶–≤–µ—Ç –¥–ª—è "–û–∫–∫—É–ø–∏—Ä–æ–≤–∞–Ω–æ"
          opacity = 0.0
          fillOpacity = 0.25// –ó–∞–ª–∏–≤–∫–∞ –ø–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω–∞—è
        } else if (feature.properties.name === '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ') {
          color = '#bdbdbd'; // –¶–≤–µ—Ç –¥–ª—è "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"
          opacity = 0.1; // –ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –≥—Ä–∞–Ω–∏—Ü—ã
          fillOpacity = 0.1; // –ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –∑–∞–ª–∏–≤–∫–∏
        }

        // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—Ç–∏–ª—å —Å –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å—é
        return {
          color: color,
          weight: 2,
          opacity: opacity,
          fillColor: color,
          fillOpacity: fillOpacity
        };
      }
    }).addTo(map);
  })
  .catch(error => console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ JSON:", error));

  let polygons = {};
let menuVisible = false;

fetch('trevoga.json')
    .then(response => response.json())
    .then(geojsonData => {
        let regions = {};
        geojsonData.features.forEach(feature => {
            let name = feature.properties.name;
            regions[name] = feature;
        });

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º "–õ—É–≥–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å" –∏ "–ê. –† –ö—Ä—ã–º"
        const autoActivateRegions = ["–õ—É–≥–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å", "–ê.–† –ö—Ä—ã–º"];
        
        document.querySelectorAll('#alert-menu input[type=checkbox]').forEach(checkbox => {
            checkbox.onchange = function() {
                let region = checkbox.id;
                if (checkbox.checked && regions[region]) {
                    let layer = L.geoJSON(regions[region], {
                        style: { color: 'red', fillColor: 'red', fillOpacity: 0.1, weight: 0.6 }
                    }).addTo(map);
                    polygons[region] = layer;
                } else if (polygons[region]) {
                    map.removeLayer(polygons[region]);
                    delete polygons[region];
                }
            };

            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—Ç–∞–≤–∏–º –≥–∞–ª–æ—á–∫—É –¥–ª—è –Ω—É–∂–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤ –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –∏—Ö
            if (autoActivateRegions.includes(checkbox.id)) {
                checkbox.checked = true;
                checkbox.onchange();  // –í—ã–∑—ã–≤–∞–µ–º onchange –≤—Ä—É—á–Ω—É—é –¥–ª—è –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞
            }
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —á–µ–∫–±–æ–∫—Å–∞ "–ü–æ –≤—Å–µ–π —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏"
        document.getElementById('–ü–æ –≤—Å–µ–π —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏').onchange = function() {
            let isChecked = this.checked;
            document.querySelectorAll('#alert-menu input[type=checkbox]').forEach(checkbox => {
                if (checkbox.id !== '–ü–æ –≤—Å–µ–π —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏') {
                    checkbox.checked = isChecked;
                    checkbox.onchange();  // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∏–ª–∏ –¥–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ–º —Ä–µ–≥–∏–æ–Ω—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è
                }
            });
        };
    });

document.getElementById('alert-button').onclick = function() {
    menuVisible = !menuVisible;
    document.getElementById('alert-menu').style.display = menuVisible ? 'block' : 'none';
};
function getKievTime() {
    const options = {
        timeZone: 'Europe/Kiev',
        hour: '2-digit',
        minute: '2-digit',
        hour12: false // 24-—á–∞—Å–æ–≤–æ–π —Ñ–æ—Ä–º–∞—Ç
    };
    return new Intl.DateTimeFormat('ru-RU', options).format(new Date());
}

let objectIdCounter = 564100;

function getNextObjectId() {
    return objectIdCounter++;


    const iconHTML = `
        <div class="icon-container ${iconClass}">
            <img src="${iconUrl}" class="icon" />
            <div class="info-container ${shiftedClass}">
                <span class="label-container ${iconClass}">${objectId} ${minskTime}</span>
                <span class="r-container ${iconClass}">–ï–ü–í–û</span>
            </div>
        </div>
    `;
    return iconHTML;
}
    fetch('line.json')
      .then(res => res.json())
      .then(data => {
        L.geoJSON(data, {
          style: {
            color: 'red',
            weight: 1,
            fill: false
          }
        }).addTo(map);
      })


    </script>
</body>
</html>
